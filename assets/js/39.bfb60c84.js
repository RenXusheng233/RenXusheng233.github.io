(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{321:function(a,t,s){"use strict";s.r(t);var n=s(14),e=Object(n.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"lerna"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna"}},[a._v("#")]),a._v(" Lerna")]),a._v(" "),t("h2",{attrs:{id:"defination"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#defination"}},[a._v("#")]),a._v(" Defination")]),a._v(" "),t("h3",{attrs:{id:"lerna-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-2"}},[a._v("#")]),a._v(" Lerna")]),a._v(" "),t("p",[a._v("Lerna is a tool that optimizes the workflow around managing multi-package repositories with git and npm.")]),a._v(" "),t("h3",{attrs:{id:"monorepo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#monorepo"}},[a._v("#")]),a._v(" monorepo")]),a._v(" "),t("p",[a._v("In version control systems, a monorepo (\"mono\" meaning 'single' and \"repo\" being short for 'repository') is a software development strategy where code for many projects is stored in the same repository. - Wikipedia")]),a._v(" "),t("h2",{attrs:{id:"getting-started"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[a._v("#")]),a._v(" Getting Started")]),a._v(" "),t("h3",{attrs:{id:"commands"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#commands"}},[a._v("#")]),a._v(" Commands")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# This flag tells Lerna to use independent versioning mode.")]),a._v("\n$ lerna init "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Bootstrap the packages in the current Lerna repo. ")]),a._v("\n$ lerna bootstrap\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Import the package at <path-to-external-repository>, with commit history, into packages/<directory-name>")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Original commit authors, dates and messages are preserved.")]),a._v("\n$ lerna "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("pathToRepo"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# --scope")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# --dev")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# --exact")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# --peer")]),a._v("\n$ lerna "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("package"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("@version"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# create a package")]),a._v("\n$ lerna create "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("package"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# --dist-tag [tagname]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# --canary/-c")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# --skip-git")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# --force-publish [packages]")]),a._v("\n$ lerna publish\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Check which packages have changed since the last release.")]),a._v("\n$ lerna changed\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Diff all packages or a single package since the last release.")]),a._v("\n$ lerna "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("diff")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("package?"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Run an npm script in each package that contains that script.")]),a._v("\n$ lerna run "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("script"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Run a command in each package.")]),a._v("\n$ lerna "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" -- "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("command"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# List all of the public packages in the current Lerna repo.")]),a._v("\n$ lerna "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Remove the node_modules directory from all packages.")]),a._v("\n$ lerna clean\n")])])]),t("h3",{attrs:{id:"config"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#config"}},[a._v("#")]),a._v(" Config")]),a._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// lerna.json")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"useWorkspaces"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"independent"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"npmClient"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"yarn"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// package.json")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"private"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"workspaces"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"packages/*"')]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("h2",{attrs:{id:"sample"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sample"}},[a._v("#")]),a._v(" Sample")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/RenXusheng233/lerna-repo",target:"_blank",rel:"noopener noreferrer"}},[a._v("Github 示例"),t("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);